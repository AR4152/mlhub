# MLHub Command Line

`r CiteDate(20200901)` The machine learning hub 
(`r Link("MLHub","https://mlhub.ai")`) is a framework and repository, through which the
capabilities of Machine Learning, Artificial Intelligence, and Data
Science are presented and accessible.  Pre-built Machine Learning and
Artificial Intelligence models as well as Data Science best practices
are presented as packages. Each package wraps its functionality into
commands that are able to be readily deployed within traditional and
powerful Unix/Linux command line pipelines.

Each MLHub package provides a **demo** command to interactively
demonstrate the capabilities of the package. A **gui** command
presents a graphical user interface through which to use the
particular capabilities of the package.  The command line oriented
commands then empower the user with the capabilities of AI and ML.

Whilst the power of the command line is an important goal of MLHub,
its usefulness must be able to be demonstrated within 5 minutes. You
decide whether the package supports something useful for you, or move
on having lost only 5 minutes of your time.

The models and technology are
accessed and managed using the `r Command(ml)` command from the free
(as in libre) and open source
`r Link("mlhub", "https://github.com/mlhubber/mlhub")` software. The software
is available for installation through
`r Link("pypi", "https://pypi.org/project/mlhub/")`.

Getting started is simple for computers running Ubuntu LTS with
packages for
`r Link("visualisations", "https://github.com/gjwgit/ports")` and
`r Link("animations", "https://github.com/gjwgit/animate")`, machine learning
models for `r Link("rain prediction", "https://github.com/gjwgit/rain")` and
`r Link("movie recommendation", "https://github.com/gjwgit/movies")`, and AI
models to
`r Link("colorize photos", "https://github.com/mlhubber/colorize")`, 
`r Link("identify objects", "https://github.com/mlhubber/objects")`, and to
`r Link("detect faces", "https://github.com/simonzhaoms/facedetect")`.

<!---------------------------------------------------------------------->
## ML Available
<!---------------------------------------------------------------------->

`r CiteDate(20200221)` After installing MLHub
(Section&nbsp;\@ref(installing-mlhub)) we are ready to install `r
Link("MLHub", "https://mlhub.ai")` packages. The simplest option is to
install *curated* packages. Such packages are reviewed by the MLHub
team and the specific details required to install a package are
obtained from a MLHub maintained index. The MLHub team review these
packages to ensure their integrity and functionality. There is though
no limit to what models can be packaged for MLHub. MLHub is able to be
pointed to any git repository and install a package based on the
MLHUB.yaml file found there.

The **available** command will list available curated models:

```bash
$ ml available
The repository 'https://mlhub.ai/' provides the following models:

animate      2.1.5  Tell a data narative through animations 
audit        4.1.0  Classic financial audit predictive classification model. 
azanomaly    3.1.4  Azure Anomaly Detection. 
azcv         2.6.0  Azure Computer Vision. 
azface       2.1.4  Azure Face API demo. 
azlang       0.0.3  Azure language cognitive service on the cloud. 
azspeech     4.1.1  Azure Speech cognitive services on the cloud. 
aztext       2.4.7  Azure Text Analytics cognitive services on the cloud. 
aztranslate  2.4.6  Azure Text Translation cognitive services on the cloud. 
barchart     2.0.2  Demonstrate the concept of barcharts. 
beeswarm     2.0.1  Demonstrate the concept of bee swarm charts. 
cars         0.0.9  Identify car make and model from a photo. 
colorize     1.5.8  Demonstrate the concept of photo colorization. 
cvbp         2.2.0  Computer vision best practices. 
easyocr      0.0.8  Extract text from images. 
facedetect   0.2.5  Simple face detection. 
facematch    0.4.2  Simple face recognition. 
iris         2.1.3  Classic iris plant species classifier. 
movies       2.0.3  Movie recommendation using the SAR algorthm. 
objects      1.6.26 Recognise objects in an image using resnet152. 
opencv       1.0.2  OpenCV Computer Vision. 
ports        2.0.0  Demostrate the concept of visualising data. 
pyiris       0.0.7  Classification models in Python using the iris dataset. 
rain         5.1.3  Predict if it will rain tomorrow (decision tree and rand... 
rbm          1.0.6  Recommendations using restricted Boltzmann machine. 
sar          1.1.6  Smart adaptive recommendations. 
scatter      2.0.1  Demonstrate the concept of scatter plots. 
sgnc         0.1.0  Node classification for graphs using StellarGraph. 
speech2txt   0.1.1  Convert audio speech to text across multiple services. 

To install a named model, local model file or URL:

  $ ml install <model>
```

<!---------------------------------------------------------------------->
## Hello World
<!---------------------------------------------------------------------->

`r CiteDate(20200311)` The MLHub package supports any number of commands
that are exposed through the individual model packages. MLHub itself
implements the following commands. Note that in the below examples
everything from the `#` to the end of the line is ignored (itâ€™s a
comment).

```console
$ ml                      # Summary of commands supported by ml.
$ ml available            # List of currated models on the MLHub.
$ ml installed            # List of models installed locally.
$ ml install   <model>    # Install the identified model.
$ ml configure <model>    # Install the model's required dependencies.
$ ml readme    <model>    # View the author's introduction of the model.
$ ml commands  <model>    # List commands supported by the model.
$ ml uninstall <model>    # Uninstall the model and (optionally) model cache.
```

Once MLHub is installed run the "*Hello World*" example which
is the *iris* model commonly used in Statistics to demonstrate
classification and prediction tasks. This uses the free and open
source R statistical software package which will have been installed
when you configured mlhub. Follow the commands here as a typical
workflow for many MLHub packages:

```console
$ ml install   iris       # Install the pre-built model named 'iris'.
$ ml configure iris       # Configure any dependencies for the model.
$ ml readme    iris       # View background information about the model.
$ ml commands  iris       # List of commands supported by the model.
$ ml demo      iris       # Run the demonstration of the pre-built model.
```

<!--

Not yet implemented 20210323

$ ml gui       iris # Graphical display of pre-built model.
$ ml score     iris # Interact with the model to predict iris.
$ ml train     iris # Supply own data and re-fit a model.
-->

Different pre-built model packages will have different system
dependencies and these will be installed by the **configure**
command. After configuration it is useful to review the packager's
commentary in their **readme**. The list of commands supported by the
package is provided by **commands**. The **demo** will then provide a
quick (couple of minutes) demonstration of the capabilities of the
package. If it looks interesting then the GUI will provide a quick
interface to some of the functionality whilst the remaining commands
provide specific functionality.

Other packages recommended for new Data Scientists to explore include
`r Link("beeswarm", "https://github.com/gjwgit/beeswarm")` and
`r Link("animate", "https://github.com/gjwgit/animate")`. For the new to ML
have a look at predicting whether it will rain tomorrow using the
`r Link("rain", "https://github.com/gjwgit/rain")` package. For Computer
Vision AI have a look at
`r Link("objects", "https://github.com/mlhubber/objects")` and
`r Link("azcv", "https://github.com/gjwgit/azcv")`.

Most model packages will support the following commands:

```bash
$ ml demo <model>         # Run the demonstration of the model.
$ ml gui  <model>         # Graphical display to utilise the model.
```

And then individual models will support model specific commands. Some
examples include:

```bash
$ ml ocr azcv <file>
$ ml identify objects <file>
$ ml color colorize <file>
$ ml listen azspeech2txt
$ ml train rain <file>
```

<!---------------------------------------------------------------------->
## ML Install
<!---------------------------------------------------------------------->

The simplest installation will then identify the package name (from
the left column of output of the `r ml_command(ml,available)`
command). For example:

```bash
$ ml install rain
```

The pacakge itself is retrieved from a git repository, and from github
by default. The file MLHUB.yaml will be obtained from that repository
which contains the metadata required to install the package for
MLHub. We can explictly identify the GitHub path, thus skipping the
curated package list:

```bash
$ ml install gjwgit/rain
```

Specific branches and commits of a GitHub repository can also be
identified. The example above accesses the master branch by
default. The first example below accesses the latest dev branch. The
second example accesses a specific commit.

```bash
$ ml install gjwgit/rain@dev
$ ml install gjwgit/rain@aace268
```

Specific MLHub yaml files within a github repository can also be identified:

```bash
$ ml install gjwgit/rain:doc/MLHUB.yaml
$ ml install https://github.com/gjwgit/rain/...
```

The default git repository is GitHub and so the above are the same as:

```bash
$ ml install github:gjwgit/rain
```

The open source GitLab repository is also supported:

```bash
$ ml install gitlab:gjwgit/rain@2fe89kh:doc/MLHUB.yaml
$ ml install https://https://gitlab.com/gjwgit/rain/...
```

As is BitBucket:

```bash
$ ml install bitbucket:gjwgit/rain
$ ml install https://bitbucket.org/gjwgit/rain/...
```

<!--
% 20200301 FROM WED SITE TO INCLUDE HERE

% <h4>Install Driect from GitHub</h4>

% <p>We can also install a MLHub package direct from github. In this way a package developer simply adds <em>MLHUB.yaml</em> and the appropriate Python or R scripts to their github repository to turn their repo into a MLHub package. The example below will access <a href="https://github.com/gjwgit/rain">https://github.com/gjwgit/rain</a>. Currently only github is supported though contributions (pull requests) to <a href="https://github.com/mlhubber/mlhub">https://github.com/mlhubber/mlhub</a> are welcome to support bitbucket and gitlab and git repositories in general.</p>

% <pre class="wp-block-preformatted">$ ml install gjwgit/rain</pre>

% <p>A git repository may contain multiple MLHub packages, like the Microsoft Recommenders best practice repository at <a href="https://github.com/gjwgit/recommenders">https://github.com/gjwgit/recommenders</a>. In this case we point mlhub to the specific configuration files.</p>

% <pre class="wp-block-preformatted">$ ml install gjwgit/recommenders:mlhub/sar.yaml<br>$ ml readme sar<br>$ ...<br><br>$ ml install gjwgit/recommenders:mlhub/rbm.yaml<br>$ ml readme rbm<br>$ ...</pre>
-->

## Unistall Packages

`r CiteDate(20200310)` To uninstall a package and thus recover any disk
space it might be using we can use the **uninstall** command. This
will also prompt for the removal of the cache maintained for this
package, which is often where the larger downloads are stored.

```bash
$ ml uninstall rain
Remove '/home/kayon/.mlhub/rain/' [Y/n]? 

Remove cache '/home/kayon/.mlhub/.cache/rain/' as well [y/N]? y

```

## Tips

`r CiteDate(20200221)` For R based models it is often useful to install
some R packages through the operating system, or else locally by a
user. For the latter case some useful packages to pre-install are
identified below. This can be done at any time, but is useful before
installing any of the R based MLHub packages. They will not then
individually need to install the packages for themselves.

```bash
$ R
> install.packages(c("rpart", "tidyverse"))
```

Similarly for common Python dependencies. One particular example is
tensorflow which does not have a Ubuntu package and thus is installed
using pip3. This can be installed any time, and any mlhub package that
requires tensorflow will not need to install it separately.

```bash
$ pip3 install tensorflow
```

If a model has installed badly, got corrupted, or not working as
expected, sometimes an uninstall followed by install will fix the
problem. When uninstalling in these circumstances it is usually a good
idea to remove the cache as well:

```bash
$ ml uninstall objects
Remove '/home/kayon/.mlhub/objects/' [Y/n]? y
Remove cache '/home/kayon/.mlhub/.cache/objects/' as well [y/N]? y

$ ml install objects
```

<!--
% CUT FROM WEB AND INCLUDED HERE INSTEAD - TODO

% <h2>Commands Auto Completion</h2>

% <p>The bash shell on Linux supports command line auto-completion which is pretty handy. You can download <a href="https://mlhub.au/ml.bash"><strong>ml.bash</strong></a> from the MLHub and place the file into <em>/etc/bash_completion.d/</em> or for later versoins of bash, into <em>~/.local/share/bash-completion/completions/</em></p>

% <pre class="wp-block-preformatted">$ wget https://mlhub.ai/ml.bash<br>THEN<br>$ sudo install -m 0644 ml.bash /etc/bash_completion.d/<br>OR (for bash --version &gt; 4.3)<br>$ mkdir -p ~/.local/share/bash-completion/completions/<br>$ mv ml.bash ~/.local/share/bash-completion/completions/</pre>

% <p>Restart the shell for the auto-completion to take effect. Then type '<em>ml '</em>&nbsp; then the beginnings of a command, like <em>'a'</em>, and then TAB to auto-complete. Auto-completion also works for model names.<br></p>

-->
